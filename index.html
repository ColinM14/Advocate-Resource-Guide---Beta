<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Advisor Resource Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: url('bg-tile.jpg');
      background-size: 300px 300px;
    }
    header {
      background: #000;
      color: white;
      padding: 20px;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    header img {
      width: 3in;
      max-width: 100%;
      display: block;
      margin: 0 auto;
    }
    header h1 {
      margin-top: 10px;
    }
    .page {
      display: none;
      padding: 20px;
    }
    .visible {
      display: block;
    }
    .home-buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      margin-top: 40px;
    }
    .home-buttons button, .home-buttons a {
      background: #715191;
      color: white;
      font-size: 18px;
      padding: 16px 32px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 280px;
      text-align: center;
      text-decoration: none;
      display: block;
      box-sizing: border-box;
    }
    .category-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .category-block {
      width: calc(50% - 20px);
      box-sizing: border-box;
    }
    .category {
      width: 90%;
      margin: 5px auto;
      padding: 16px;
      font-size: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #009ca7;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 5px;
    }
    .category.active {
      background: #66b1e2;
    }
    .star-button {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: gold;
    }
    .resources-wrapper {
      display: none;
      margin-bottom: 20px;
    }
    .resource-card {
      background: white;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-top: 10px;
    }
        .search-result-category {
      font-size: 16px;
      color: #555;
      margin-top: 25px;
      margin-bottom: -5px;
      padding-left: 10px;
      border-bottom: 2px solid #eee;
      padding-bottom: 5px;
    }
    .copy-button {
      background: #66b1e2;
      color: white;
      border: none;
      padding: 10px 14px;
      margin-right: 10px;
      border-radius: 4px;
      cursor: pointer;
    }
    .action-button {
      display: inline-block;
      background: #009ca7;
      color: white;
      padding: 10px 20px;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
    }
      .website-button {
      display: inline-block;
      background: #715191;
      color: white;
      padding: 10px 16px;
      margin: 12px 0;
      border: none;
      border-radius: 4px;
      text-align: center;
      font-weight: bold;
      cursor: pointer;
      text-decoration: none;
}
    .back-button {
      position: sticky;
      background: #fff;
      padding: 12px;
      border-bottom: 2px solid #ccc;
      font-weight: bold;
      color: black;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 1000;
      top: 84px; /* Will be set by JS to match header height */
    }
    .card {
      background: white;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin: 20px auto;
      max-width: 600px;
    }
    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
.category-buttons {
  display: flex;
  align-items: center;
  gap: 10px;
}
.copy-category-button {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  color: white;
}
.search-bar {
  display: flex;
  gap: 10px;
  margin-top: 15px;
}
.search-bar input {
  flex-grow: 1;
  padding: 10px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 4px;
}
.search-bar button {
  padding: 10px 20px;
  font-size: 16px;
  background: #009ca7;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
    .form-checkbox-label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 16px;
  background-color: #f0f0f0;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
}
.form-checkbox-label input {
  width: 18px;
  height: 18px;
}
.copy-forms-container {
  position: sticky;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 15px;
  background-color: rgba(255, 255, 255, 0.9);
  border-top: 1px solid #ddd;
  box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
  display: flex;
  gap: 10px;
}

.copy-forms-container button {
  flex: 1;
  padding: 16px;
  font-size: 18px;
  font-weight: bold;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

#copySelectedFormsText, #copySelectedVAFormsText {
  background: #66b1e2;
}

#copySelectedForms, #copySelectedVAForms {
  background: #715191;
}
  </style>
</head>
<body>
<header id="main-header">
  <img src="https://carepatrol.com/wp-content/uploads/sites/2/2023/07/CP_CarePatrol-Logo_CMYK.svg" alt="CarePatrol Logo" />
  <h1>Advisor Hub</h1>
</header>
<div id="home" class="page visible">
  <div class="home-buttons">
    <button onclick="showPage('resources')">Partner Network</button>
    <button onclick="showPage('forms')">Low Income Documents</button>
    <button onclick="showPage('varesources')">VA Resources</button>
    <button onclick="showPage('disclosures')">Disclosures</button>
    <!-- Commitment Made button with confetti effect -->
    <button id="commitmentBtn">Commitment Made</button>
    <button onclick="showPage('search')">Search</button>
    <button onclick="showPage('favorites')">‚≠ê My Favorites</button>
    <button onclick="copyText('Your feedback means a lot! Leave us a quick Google review here: https://g.page/r/CVXT-a832BjDEAE/review')">Share Google Link</button>
  </div>
</div>

<div id="resources" class="page">
  <div class="back-button" onclick="showPage('home')">üè† Back to Home</div>
  <div id="resourceContent"></div>
</div>

<div id="forms" class="page">
  <div class="back-button" onclick="showPage('home')">üè† Back to Home</div>
  <div class="card">
    <h3>2024 AAA Colorado Adult Medicaid Programs</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1wt0eQ-WrU9AhUXl-FSDknpgNjHUYMjR3/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1wt0eQ-WrU9AhUXl-FSDknpgNjHUYMjR3/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  
<div class="card">
    <h3>2025 Medicaid - Social Security Income Limits</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1FUX4sFJbIgXH7shNrRNh1akD20qMmdV-/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1FUX4sFJbIgXH7shNrRNh1akD20qMmdV-/view?usp=drive_link"> Select
      </label>
    </div>
  </div>

  <div class="card">
    <h3>2025 Medicaid Pending List</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1C4Swa14RaUsgRvnNZr-tZSWNO0UI_Shw/view?usp=sharing" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1C4Swa14RaUsgRvnNZr-tZSWNO0UI_Shw/view?usp=sharing"> Select
      </label>
    </div>
  </div>
  
  <div class="card">
    <h3>Assisted Living - Medicaid Community list</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1yb6LQjrYr2g3hXMAlMv8RN0N1QY8P_tS/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1yb6LQjrYr2g3hXMAlMv8RN0N1QY8P_tS/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  
  <div class="card">
    <h3>Home Care - Medicaid List</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1sttdj6hKVOjIC_9dV7KC7nbFoOYUgcPv/view?usp=sharing" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1sttdj6hKVOjIC_9dV7KC7nbFoOYUgcPv/view?usp=sharing"> Select
      </label>
    </div>
  </div>

  <div class="card">
    <h3>Income Based Housing - Seniors 2025</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1_NsBXxZqzhnezskSrIAn-aZ6r2YO_rXw/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1_NsBXxZqzhnezskSrIAn-aZ6r2YO_rXw/view?usp=drive_link"> Select
      </label>
    </div>
  </div>

  <div class="card">
    <h3>Income Trust Application</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1NWfZefcbgrLk9v3ah_036Wdr_JCyHIXN/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1NWfZefcbgrLk9v3ah_036Wdr_JCyHIXN/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
    
  <div class="card">
    <h3>Instructions for Completing the Income Trust Form</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1Tqd5OwC9_x1SBWkPNTLjZ9V0D5qLC8YG/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/1Tqd5OwC9_x1SBWkPNTLjZ9V0D5qLC8YG/view?usp=drive_link"> Select
      </label>
    </div>
  </div>

  <div class="card">
    <h3>LTC Medicaid Application</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/187hit7OET1BEYejH-ltZfqZmGGP8Mdy6/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/187hit7OET1BEYejH-ltZfqZmGGP8Mdy6/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
    
  <div class="card">
    <h3>Medicaid One Pager Application</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/19eSfo4CAGHL-LafVcRb2kQ10w0W9C58W/view?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/19eSfo4CAGHL-LafVcRb2kQ10w0W9C58W/view?usp=drive_link"> Select
      </label>
    </div>
  </div>

  <div class="card">
    <h3>Nursing Home List / Medicaid Long Term Care</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/132JpSIaIiBrfnuvvhtVq0PxTjEI-G9Ld/view?usp=sharing" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://drive.google.com/file/d/132JpSIaIiBrfnuvvhtVq0PxTjEI-G9Ld/view?usp=sharing"> Select
      </label>
    </div>
  </div>

  <div class="card">
    <h3>Medicaid Application Instructions</h3>
    <div class="button-row">
      <a href="https://docs.google.com/document/d/1DfTigUZBvnwVXcctxprnxSrRicpv6C1G9oZ0z7ZH4f8/edit?usp=drive_link" target="_blank" class="action-button">Visit Document</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="form-checkbox" data-link="https://docs.google.com/document/d/1DfTigUZBvnwVXcctxprnxSrRicpv6C1G9oZ0z7ZH4f8/edit?usp=drive_link"> Select
      </label>
    </div>
  </div>

<div class="copy-forms-container">
  <button id="copySelectedForms">Share Selected Links</button>
  <button id="copySelectedFormsText">Copy Links</button>
</div>
</div>

<div id="varesources" class="page">
  <div class="back-button" onclick="showPage('home')">üè† Back to Home</div>
  <!-- VA Resources Cards -->
  <div class="card">
    <h3>VA Nursing Homes State & Federal</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1cj4x4PedhK4YcT9k-LnGnSnO45JV1F24/view?usp=drive_link" target="_blank" class="action-button">Visit Resource</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="va-form-checkbox" data-link="https://drive.google.com/file/d/1cj4x4PedhK4YcT9k-LnGnSnO45JV1F24/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  <div class="card">
    <h3>Links to VA Resources</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1d_aFn5JI10ulhklgxPqKobSGdIod_kYx/view?usp=drive_link" target="_blank" class="action-button">Visit Resource</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="va-form-checkbox" data-link="https://drive.google.com/file/d/1d_aFn5JI10ulhklgxPqKobSGdIod_kYx/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  <div class="card">
    <h3>CCNH Homes ECHS</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1QRgaFev9bv6vEOKNhUpT_QO7ijluqqgL/view?usp=drive_link" target="_blank" class="action-button">Visit Resource</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="va-form-checkbox" data-link="https://drive.google.com/file/d/1QRgaFev9bv6vEOKNhUpT_QO7ijluqqgL/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  <div class="card">
    <h3>Application 22214 Military Service Record</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1fUpnbA-io-rM4EXuuWkBThSiXONKRrxF/view?usp=drive_link" target="_blank" class="action-button">Visit Resource</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="va-form-checkbox" data-link="https://drive.google.com/file/d/1fUpnbA-io-rM4EXuuWkBThSiXONKRrxF/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  <div class="card">
    <h3>2025 VA - Aid and Attendance Flyer</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/136NvSFU08o_Rm0HyhIzAEPQ4VKdA0QNr/view?usp=sharing" target="_blank" class="action-button">Visit Resource</a>
      <label class="form-checkbox-label">
        <input type="checkbox" class="va-form-checkbox" data-link="https://drive.google.com/file/d/1EHRiqbBlYlydKp-Rxc2MAYTu1swkzYkC/view?usp=drive_link"> Select
      </label>
    </div>
  </div>
  <div class="copy-forms-container">
    <button id="copySelectedVAForms">Share Selected Links</button>
    <button id="copySelectedVAFormsText">Copy Links</button>
  </div>
</div>
  
<div id="disclosures" class="page">
  <div class="back-button" onclick="showPage('home')">üè† Back to Home</div>
  <div class="card">
    <h3>General Disclosure</h3>
    <div class="button-row">
      <a href="https://fs11.formsite.com/5LkyVC/sjuyzngbeg/index" target="_blank" class="action-button">Visit Link</a>
      <button class="copy-button" onclick="copyText('https://fs11.formsite.com/5LkyVC/sjuyzngbeg/index')">Copy Link</button>
    </div>
  </div>
  <div class="card">
    <h3>James Disclosure</h3>
    <div class="button-row">
      <a href="https://fs11.formsite.com/5LkyVC/iyvtmjabzy/index" target="_blank" class="action-button">Visit Link</a>
      <button class="copy-button" onclick="copyText('https://fs11.formsite.com/5LkyVC/iyvtmjabzy/index')">Copy Link</button>
    </div>
  </div>
  <div class="card">
    <h3>Laura Disclosure</h3>
    <div class="button-row">
      <a href="https://fs11.formsite.com/5LkyVC/7nsowaf7rp/index" target="_blank" class="action-button">Visit Link</a>
      <button class="copy-button" onclick="copyText('https://fs11.formsite.com/5LkyVC/7nsowaf7rp/index')">Copy Link</button>
    </div>
  </div>
  <div class="card">
    <h3>Rami Disclosure</h3>
    <div class="button-row">
      <a href="https://fs11.formsite.com/5LkyVC/admx42e1ut/index" target="_blank" class="action-button">Visit Link</a>
      <button class="copy-button" onclick="copyText('https://fs11.formsite.com/5LkyVC/admx42e1ut/index')">Copy Link</button>
    </div>
  </div>
  <div class="card">
    <h3>Printable Disclosure</h3>
    <div class="button-row">
      <a href="https://drive.google.com/file/d/1xD2xDR2aPBLL2Kg2rBGdNnzZcaQBZKHf/view?usp=sharing" target="_blank" class="action-button">Visit Link</a>
      <button class="copy-button" onclick="copyText('https://drive.google.com/file/d/1xD2xDR2aPBLL2Kg2rBGdNnzZcaQBZKHf/view?usp=sharing')">Copy Link</button>
    </div>
  </div>
</div>

<div id="favorites" class="page">
  <div class="back-button" onclick="showPage('home')">üè† Back to Home</div>
  <div id="favoritesContent">
    <p>Loading favorites...</p>
  </div>
</div>
  
<div id="search" class="page">
  <div class="back-button" onclick="showPage('home')">üè† Back to Home</div>
  <div class="card">
    <h3>Search Resources</h3>
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search by name, category, etc...">
      <button id="searchButton">Search</button>
    </div>
  </div>
  <div id="searchResults"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
let allResources = [];

fetch("data.json")
  .then(res => res.json())
  .then(data => {
    allResources = data;
    console.log("Resources loaded and ready.");
  })
  .catch(error => console.error("Error fetching data:", error));

document.addEventListener('DOMContentLoaded', () => {
   const commitmentBtn = document.getElementById('commitmentBtn');
  if (commitmentBtn) {
commitmentBtn.addEventListener('click', () => {
  confetti({
    particleCount: 150,
    spread: 70,
    origin: { y: 0.6 }
  });
  setTimeout(() => {
    window.open('https://docs.google.com/forms/d/e/1FAIpQLSf0mp6Mo2UhWrpg0S_pSaamZoi8sVK3Ublzp_cUGbtd_Xeslg/viewform?usp=dialog', '_blank');
  }, 1000); // 1 seconds delay (2000 ms)
});
  }
  // --- Search Listeners (no change) ---
  const searchButton = document.getElementById('searchButton');
  const searchInput = document.getElementById('searchInput');
  if (searchButton) {
    searchButton.addEventListener('click', performSearch);
  }
  if (searchInput) {
    searchInput.addEventListener('keyup', (event) => {
      if (event.key === 'Enter') performSearch();
    });
  }
 // --- Button Listeners for the Low Income Documents Page ---
 const shareFormsButton = document.getElementById('copySelectedForms');
  const copyFormsTextButton = document.getElementById('copySelectedFormsText');
  if (copyFormsTextButton) {
    copyFormsTextButton.addEventListener('click', () => {
      const checkedBoxes = document.querySelectorAll('#forms .form-checkbox:checked');
      if (checkedBoxes.length === 0) {
        alert("Please select one or more documents to copy.");
        return;
      }
      const links = Array.from(checkedBoxes).map(box => box.dataset.link);
      const textToCopy = links.join('\n');
      navigator.clipboard.writeText(textToCopy).then(() => {
        alert(`Copied ${links.length} link(s) to the clipboard.`);
        checkedBoxes.forEach(box => box.checked = false);
      });
    });
  }
  if (shareFormsButton) {
    shareFormsButton.addEventListener('click', () => {
      const checkedBoxes = document.querySelectorAll('#forms .form-checkbox:checked');
      if (checkedBoxes.length === 0) {
        alert("Please select one or more documents to share.");
        return;
      }
      const links = Array.from(checkedBoxes).map(box => box.dataset.link);
      const textToShare = "Here are the links you requested:\n" + links.join('\n');
      if (navigator.share) {
        navigator.share({
          title: 'Shared Document Links',
          text: textToShare,
        })
        .then(() => {
          checkedBoxes.forEach(box => box.checked = false);
        })
        .catch((error) => console.log('Error sharing', error));
      } else {
        alert("Share feature not available on this browser. Use the 'Copy Links' button instead.");
      }
    });
  }

  // VA Resources Page listeners
  const shareVAFormsButton = document.getElementById('copySelectedVAForms');
  const copyVAFormsTextButton = document.getElementById('copySelectedVAFormsText');
  if (copyVAFormsTextButton) {
    copyVAFormsTextButton.addEventListener('click', () => {
      const checkedBoxes = document.querySelectorAll('#varesources .va-form-checkbox:checked');
      if (checkedBoxes.length === 0) {
        alert("Please select one or more VA resources to copy.");
        return;
      }
      const links = Array.from(checkedBoxes).map(box => box.dataset.link);
      const textToCopy = links.join('\n');
      navigator.clipboard.writeText(textToCopy).then(() => {
        alert(`Copied ${links.length} link(s) to the clipboard.`);
        checkedBoxes.forEach(box => box.checked = false);
      });
    });
  }
   if (shareVAFormsButton) {
    shareVAFormsButton.addEventListener('click', () => {
      const checkedBoxes = document.querySelectorAll('#varesources .va-form-checkbox:checked');
      if (checkedBoxes.length === 0) {
        alert("Please select one or more VA resources to share.");
        return;
      }
      const links = Array.from(checkedBoxes).map(box => box.dataset.link);
      const textToShare = "Here are the VA resource links you requested:\n" + links.join('\n');
      if (navigator.share) {
        navigator.share({
          title: 'Shared VA Resource Links',
          text: textToShare,
        })
        .then(() => {
          checkedBoxes.forEach(box => box.checked = false);
        })
        .catch((error) => console.log('Error sharing', error));
      } else {
        alert("Share feature not available on this browser. Use the 'Copy Links' button instead.");
      }
    });
  }
});

// Utility functions
function copyText(text) {
  navigator.clipboard.writeText(text).then(() => alert("Copied: " + text));
}

function createResourceCard(resource) {
  const card = document.createElement("div");
  card.className = "resource-card";
  const hasWebsite = resource.Website && resource.Website.trim() && resource.Website !== "null";
  const hasPhone = resource.Phone && resource.Phone !== "null";
  const hasAddress = resource.Address && resource.Address !== "null";
  const hasDescription = resource.Description && resource.Description !== "null";
  card.innerHTML = `
    <h3>${resource.Name}</h3>
    ${hasWebsite ? `<a class="website-button" href="${resource.Website}" target="_blank">Visit Website</a>` : ""}
    ${hasPhone ? `<p><strong>Phone:</strong> ${resource.Phone}</p>` : ""}
    ${hasAddress ? `<p><strong>Address:</strong> ${resource.Address}</p>` : ""}
    ${hasDescription ? `<p>${resource.Description}</p>` : ""}
    <div class="button-row">
      ${hasPhone ? `<button class="copy-button" onclick="copyText('${resource.Name}\\n${resource.Phone}')">Copy Phone</button>` : ""}
      ${hasWebsite ? `<button class="copy-button" onclick="copyText('${resource.Name}\\n${resource.Website}')">Copy Website</button>` : ""}
    </div>
  `;
  return card;
}

function performSearch() {
  const searchInput = document.getElementById('searchInput');
  const resultsContainer = document.getElementById('searchResults');
  const searchTerm = searchInput.value.toLowerCase().trim();
  resultsContainer.innerHTML = '';
  if (!searchTerm) return;
  const searchResults = allResources.filter(resource => {
    const nameMatch = resource.Name && resource.Name.toLowerCase().includes(searchTerm);
    const descMatch = resource.Description && resource.Description.toLowerCase().includes(searchTerm);
    const catMatch = resource.Category && resource.Category.toLowerCase().includes(searchTerm);
    return nameMatch || descMatch || catMatch;
  });
  if (searchResults.length > 0) {
    searchResults.forEach(resource => {
      const categoryHeader = document.createElement("h4");
      categoryHeader.className = "search-result-category";
      categoryHeader.textContent = `Category: ${resource.Category}`;
      const cardElement = createResourceCard(resource);
      resultsContainer.appendChild(categoryHeader);
      resultsContainer.appendChild(cardElement);
    });
  } else {
    resultsContainer.innerHTML = '<p style="text-align: center; margin-top: 20px;">No results found.</p>';
  }
}

function getFavorites() {
  return JSON.parse(localStorage.getItem("favorites") || "[]");
}

function isFavorite(cat) {
  return getFavorites().includes(cat);
}

function toggleFavorite(cat) {
  let favs = getFavorites();
  if (favs.includes(cat)) {
    favs = favs.filter(c => c !== cat);
  } else {
    favs.push(cat);
  }
  localStorage.setItem("favorites", JSON.stringify(favs));
}

function loadResources() {
  const container = document.getElementById("resourceContent");
  if (container.dataset.loaded) return;
  container.dataset.loaded = true;
  container.innerHTML = ''; 
  const categories = [...new Set(allResources.map(item => item.Category))].sort();
  const row = document.createElement("div");
  row.className = "category-row";
  categories.forEach(cat => {
    const block = document.createElement("div");
    block.className = "category-block";
    const catDiv = document.createElement("div");
    catDiv.className = "category";
    const catLabel = document.createElement("span");
    catLabel.textContent = cat;
    const buttonGroup = document.createElement('div');
    buttonGroup.className = "category-buttons";
    const copyCatBtn = document.createElement("button");
    copyCatBtn.className = "copy-category-button";
    copyCatBtn.innerHTML = "üìã";
    copyCatBtn.title = "Copy all resources in this category";
    const sortedResources = allResources.filter(item => item.Category === cat);
    copyCatBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      let textToCopy = `Resources for ${cat}:\n\n`;
      sortedResources.forEach(resource => {
        textToCopy += `Name: ${resource.Name}\n`;
        if (resource.Phone && resource.Phone !== "null") textToCopy += `Phone: ${resource.Phone}\n`;
        if (resource.Address && resource.Address !== "null") textToCopy += `Address: ${resource.Address}\n`;
        if (resource.Website && resource.Website !== "null") textToCopy += `Website: ${resource.Website}\n`;
        if (resource.Description && resource.Description !== "null") textToCopy += `Description: ${resource.Description}\n`;
        textToCopy += `--------------------------------\n\n`;
      });
      navigator.clipboard.writeText(textToCopy.trim());
      alert(`Copied all resources for "${cat}"`);
    });
    const star = document.createElement("button");
    star.className = "star-button";
    star.innerHTML = isFavorite(cat) ? "‚òÖ" : "‚òÜ";
    star.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleFavorite(cat);
      star.innerHTML = isFavorite(cat) ? "‚òÖ" : "‚òÜ";
    });
    buttonGroup.appendChild(copyCatBtn);
    buttonGroup.appendChild(star);
    catDiv.appendChild(catLabel);
    catDiv.appendChild(buttonGroup);
    const wrapper = document.createElement("div");
    wrapper.className = "resources-wrapper";
    sortedResources
      .sort((a, b) => a.Name.localeCompare(b.Name))
      .forEach(resource => {
        const cardElement = createResourceCard(resource);
        wrapper.appendChild(cardElement);
      });
    catDiv.addEventListener("click", () => {
      const isOpen = wrapper.style.display === "block";
      document.querySelectorAll(".resources-wrapper").forEach(w => w.style.display = "none");
      document.querySelectorAll(".category").forEach(c => c.classList.remove("active"));
      if (!isOpen) {
        wrapper.style.display = "block";
        catDiv.classList.add("active");
      }
    });
    block.appendChild(catDiv);
    block.appendChild(wrapper);
    row.appendChild(block);
  });
  container.appendChild(row);
}

function loadFavorites() {
  const container = document.getElementById("favoritesContent");
  container.innerHTML = "";
  const favs = getFavorites();
  if (favs.length === 0) {
      container.innerHTML = '<p style="text-align: center; margin-top: 20px;">You have no favorite categories yet.</p>';
      return;
  }
  favs.forEach(cat => {
    const catDiv = document.createElement("div");
    catDiv.className = "category";
    const catLabel = document.createElement("span");
    catLabel.textContent = cat;
    const buttonGroup = document.createElement('div');
    buttonGroup.className = "category-buttons";
    const copyCatBtn = document.createElement("button");
    copyCatBtn.className = "copy-category-button";
    copyCatBtn.innerHTML = "üìã";
    copyCatBtn.title = "Copy all resources in this category";
    const sortedResources = allResources.filter(item => item.Category === cat);
    copyCatBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      let textToCopy = `Resources for ${cat}:\n\n`;
      sortedResources.forEach(resource => {
        textToCopy += `Name: ${resource.Name}\n`;
        if (resource.Phone && resource.Phone !== "null") textToCopy += `Phone: ${resource.Phone}\n`;
        if (resource.Address && resource.Address !== "null") textToCopy += `Address: ${resource.Address}\n`;
        if (resource.Website && resource.Website !== "null") textToCopy += `Website: ${resource.Website}\n`;
        if (resource.Description && resource.Description !== "null") textToCopy += `Description: ${resource.Description}\n`;
        textToCopy += `--------------------------------\n\n`;
      });
      navigator.clipboard.writeText(textToCopy.trim());
      alert(`Copied all resources for "${cat}"`);
    });
    buttonGroup.appendChild(copyCatBtn);
    catDiv.appendChild(catLabel);
    catDiv.appendChild(buttonGroup);
    const wrapper = document.createElement("div");
    wrapper.className = "resources-wrapper";
    sortedResources
      .sort((a, b) => a.Name.localeCompare(b.Name))
      .forEach(resource => {
        const cardElement = createResourceCard(resource);
        wrapper.appendChild(cardElement);
      });
    catDiv.addEventListener("click", () => {
      const isOpen = wrapper.style.display === "block";
      document.querySelectorAll("#favoritesContent .resources-wrapper").forEach(w => w.style.display = "none");
      document.querySelectorAll("#favoritesContent .category").forEach(c => c.classList.remove("active"));
      if (!isOpen) {
        wrapper.style.display = "block";
        catDiv.classList.add("active");
      }
    });
    container.appendChild(catDiv);
    container.appendChild(wrapper);
  });
}

function showPage(id) {
  document.querySelectorAll('.page').forEach(page => {
    page.classList.remove('visible');
  });
  document.getElementById(id).classList.add('visible');
  const pagesWithBackButton = ['resources', 'favorites', 'disclosures', 'forms', 'varesources', 'search'];
  if (pagesWithBackButton.includes(id)) {
    const header = document.getElementById('main-header');
    const backButton = document.querySelector(`#${id} .back-button`);
    if (header && backButton) {
      backButton.style.top = header.offsetHeight + 'px';
    }
  }
  if (id === 'resources') loadResources();
  if (id === 'favorites') loadFavorites();
}
</script>
</body>
</html>
